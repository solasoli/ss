!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(e){"use strict";var t=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.blobSlice=t&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[]}},e.parseMetaData=function(t,a,i,o){i=i||{},o=o||{};var r=this,n=i.maxMetaDataSize||262144;!!(window.DataView&&t&&t.size>=12&&"image/jpeg"===t.type&&e.blobSlice)&&e.readFile(e.blobSlice.call(t,0,n),function(t){if(t.target.error)return console.log(t.target.error),void a(o);var n,l,s,c,f=t.target.result,g=new DataView(f),d=2,m=g.byteLength-4,p=d;if(65496===g.getUint16(0)){for(;d<m&&((n=g.getUint16(d))>=65504&&n<=65519||65534===n);){if(l=g.getUint16(d+2)+2,d+l>g.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(s=e.metaDataParsers.jpeg[n])for(c=0;c<s.length;c+=1)s[c].call(r,g,d,l,o,i);p=d+=l}!i.disableImageHead&&p>6&&(f.slice?o.imageHead=f.slice(0,p):o.imageHead=new Uint8Array(f).subarray(0,p))}else console.log("Invalid JPEG file: Missing JPEG marker.");a(o)},"readAsArrayBuffer")||a(o)},e.hasMetaOption=function(e){return e.meta};var a=e.transform;e.transform=function(t,i,o,r,n){e.hasMetaOption(i||{})?e.parseMetaData(r,function(n){a.call(e,t,i,o,r,n)},i,n):a.apply(e,arguments)}});