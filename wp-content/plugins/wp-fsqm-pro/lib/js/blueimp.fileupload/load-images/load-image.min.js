!function(t){"use strict";function e(t,n,o){var r,i=document.createElement("img");if(i.onerror=function(r){return e.onerror(i,r,t,n,o)},i.onload=function(r){return e.onload(i,r,t,n,o)},e.isInstanceOf("Blob",t)||e.isInstanceOf("File",t))r=i._objectURL=e.createObjectURL(t);else{if("string"!=typeof t)return!1;r=t,o&&o.crossOrigin&&(i.crossOrigin=o.crossOrigin)}return r?(i.src=r,i):e.readFile(t,function(t){var e=t.target;e&&e.result?i.src=e.result:n&&n(t)})}function n(t,n){!t._objectURL||n&&n.noRevoke||(e.revokeObjectURL(t._objectURL),delete t._objectURL)}var o=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;e.isInstanceOf=function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"},e.transform=function(t,n,o,r,i){o(e.scale(t,n,i),i)},e.onerror=function(t,e,o,r,i){n(t,i),r&&r.call(t,e)},e.onload=function(t,o,r,i,a){n(t,a),i&&e.transform(t,a,i,r,{})},e.transformCoordinates=function(){},e.getTransformedOptions=function(t,e){var n,o,r,i,a=e.aspectRatio;if(!a)return e;n={};for(o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);return n.crop=!0,r=t.naturalWidth||t.width,i=t.naturalHeight||t.height,r/i>a?(n.maxWidth=i*a,n.maxHeight=i):(n.maxWidth=r,n.maxHeight=r/a),n},e.renderImageToCanvas=function(t,e,n,o,r,i,a,c,d,s){return t.getContext("2d").drawImage(e,n,o,r,i,a,c,d,s),t},e.hasCanvasOption=function(t){return t.canvas||t.crop||!!t.aspectRatio},e.scale=function(t,n,o){function r(){var t=Math.max((d||O)/O,(s||L)/L);t>1&&(O*=t,L*=t)}function i(){var t=Math.min((a||O)/O,(c||L)/L);t<1&&(O*=t,L*=t)}n=n||{};var a,c,d,s,u,h,f,g,l,m,v,w=document.createElement("canvas"),R=t.getContext||e.hasCanvasOption(n)&&w.getContext,p=t.naturalWidth||t.width,b=t.naturalHeight||t.height,O=p,L=b;if(R&&(f=(n=e.getTransformedOptions(t,n,o)).left||0,g=n.top||0,n.sourceWidth?(u=n.sourceWidth,void 0!==n.right&&void 0===n.left&&(f=p-u-n.right)):u=p-f-(n.right||0),n.sourceHeight?(h=n.sourceHeight,void 0!==n.bottom&&void 0===n.top&&(g=b-h-n.bottom)):h=b-g-(n.bottom||0),O=u,L=h),a=n.maxWidth,c=n.maxHeight,d=n.minWidth,s=n.minHeight,R&&a&&c&&n.crop?(O=a,L=c,(v=u/h-a/c)<0?(h=c*u/a,void 0===n.top&&void 0===n.bottom&&(g=(b-h)/2)):v>0&&(u=a*h/c,void 0===n.left&&void 0===n.right&&(f=(p-u)/2))):((n.contain||n.cover)&&(d=a=a||d,s=c=c||s),n.cover?(i(),r()):(r(),i())),R){if((l=n.pixelRatio)>1&&(w.style.width=O+"px",w.style.height=L+"px",O*=l,L*=l,w.getContext("2d").scale(l,l)),(m=n.downsamplingRatio)>0&&m<1&&O<u&&L<h)for(;u*m>O;)w.width=u*m,w.height=h*m,e.renderImageToCanvas(w,t,f,g,u,h,0,0,w.width,w.height),u=w.width,h=w.height,(t=document.createElement("canvas")).width=u,t.height=h,e.renderImageToCanvas(t,w,0,0,u,h,0,0,u,h);return w.width=O,w.height=L,e.transformCoordinates(w,n),e.renderImageToCanvas(w,t,f,g,u,h,0,0,O,L)}return t.width=O,t.height=L,t},e.createObjectURL=function(t){return!!o&&o.createObjectURL(t)},e.revokeObjectURL=function(t){return!!o&&o.revokeObjectURL(t)},e.readFile=function(t,e,n){if(window.FileReader){var o=new FileReader;if(o.onload=o.onerror=e,n=n||"readAsDataURL",o[n])return o[n](t),o}return!1},"function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof module&&module.exports?module.exports=e:t.loadImage=e}(window);